# Лабораторная работа №3 по моделированию
## Постановка задачи

Физическая суть лабораторной: необходимо рассчитать температуру на всей длине стержня, который нагревают с одного из торцов.

![](../assets/l3_scheme.png)

Исходные данные:
* l = 10см (Длина стержня)
* R = 0.5см (Радиус стержня)
* Tenv = 300К (Температура окружающей среды)
* F0 = 100 Вт / (см^2 * К) (Плотность теплового потока)
* k0 = 0.1 Вт / (см * К) (Коэффициент теплопроводности в начале стержня)
* kN = 0.2 Вт / (см * К) (Коэффициент теплопроводности в конце стержня)
* α0 = 1e-2  Вт / (см^2 * К) (Коэффициент теплоотдачи в начале стержня)
* αN = 0.9e-2  Вт / (см^2 * К) (Коэффициент теплоотдачи в конце стержня)

Все параметры могут быть изменены из интерфейса

Рассчитывать T(x) будем при помощи подготовленного уравнения теплопроводности:

![](../assets/1.png)

И заданных граничных условий:

![](../assets/2.png)

![](../assets/3.png)

## Коэффициенты теплопроводности и теплоотдачи

_Рассмотрим только нахождение коэффициента теплоотдачи, коэффициент теплопроводности будет вычисляться точно так же, надо только заменить везде α на k._
По условию коэффициент `α` есть функция от `х`:

![](../assets/4.png)

Нам неизвестны коэффициенты `a` и `b`, однако нам даны `α(0) = α0` и `α(l) = αN`. Нужно лишь составить систему из двух уравнений и решить ее. Задача достаточно проста, и приводить саму систему и ее решение не будем. Итак, из системы получаем коэффициенты `a` и `b`:

![](../assets/5.png)

![](../assets/6.png)

## Метод прогонки

Несколько заходя вперед, скажем, что для решения исходного уравнения надо будет получить разностную схему, из которой, в свою очередь, получится система из N уравнений, которую можно будет подогнать и решить методом прогонки. Метод прогонки дается в общем виде, и предполагается, что закодить ее надо также в общем виде.

Имеем систему уравнений следующего вида:

![](../assets/7.png) (т.е. это не одно уравнение, а набор для n от 1 до N-1)

![](../assets/8.png)

![](../assets/9.png)

В качестве исходных данных в метод прогонки надо будет передавать:
* 4 массива: `An`, `Bn`, `Cn`, `Fn`
* 3 параметра для граничного условия слева: `K0`, `M0`, `P0`
* 3 параметра для граничного условия справа: `KN`, `MN`, `PN`

По сути, система решается в два прохода: прямой и обратный.

В прямом ходе вычисляем прогоночные коэффициенты `ξ` и `η` от 1 до :

![](../assets/10.png)

![](../assets/11.png)

Начальные значения `ξ` и `η` берутся из граничных условий:

![](../assets/12.png)

_Обратите внимание, что прогоночные коэффициенты начинаются с первого, а не с нулевого. И вообще осторожнее с индексами в этом методе, с ними связана большая часть багов._

Затем в обратном ходе вычисляется решение системы `y0...yN`:

![](../assets/13.png)

Начальное значение `yN` считается из граничных условий:

![](../assets/14.png)

## Получение разностной схемы из ДУ

Разностная схема в данном случае получается при помощи достаточно сильного колдунства и интегро-интерполяционного метода. Все формулы будут приведены в общем виде, но поменять функции на те, что даны в лабораторной будет несложно. Полный вывод можно найти в лекциях.

Итак, имеем уравнение:

![](../assets/15.png)

Введем обозначение:

![](../assets/16.png)

Тогда:

![](../assets/17.png)

Проинтегрируем **(3)** на ячейке:

![](../assets/18.png)

Первый интеграл считается тривиально, а второй и третий проинтегрируем методом средних прямоугольников:

![](../assets/19.png)

Проинтегрируем **(2)**:

![](../assets/20.png)

...блджать, как будто это кто-то будет изучать.

### Суть

После определенных манипуляций имеем выражение вида

![](../assets/21.png)

которое нам и нужно для метода прогонки. Соответствующие коэффициенты вычисляются как:

![](../assets/22.png)

![](../assets/23.png)

![](../assets/24.png)

![](../assets/25.png)

При этом

![](../assets/26.png)

![](../assets/27.png)

![](../assets/28.png)

![](../assets/29.png)

## Граничные условия

Нам уже известны все параметры, кроме коэффициентов K0, M0, P0 левого граничного условия и KN, MN, PN правого граничного условия.

### Левое граничное условие

Для получения уравнения вида `K0*y0 + M0*y1 = P0` проинтегрируем **(3)** на половине первого шага:

![](../assets/30.png)

_Не особо понял, куда делся минус в первом интеграле, но так дано в лекциях_

Первый интеграл раскрывается тривиально, а второй и третий посчитаем численно методом трапеций (с одним интервалом).

![](../assets/31.png)

Из полученного при выводе разностной схемы (эта часть вывода пока опущена) имеем:

![](../assets/32.png)

`F0` мы берем из заданного граничного условия (фактически, это тот самый `F0`, который значится в исходных данных). Подставляем значения в уравнение, приводим к благообразному виду и имеем:

![](../assets/33.png)

Соответственно, коэффициент при y0 будет K0, коэффициент при y1 - M0, и справа стоит P0.

### Правое граничное условие

Его вывод на лекциях не давался - нужно сделать самостоятельно и показать при сдаче.

Итак, похожим образом интегрируем на половине теперь уже последнего интервала:

![](../assets/34.png)

_Минус перед первым интегралом снова тут. Почему? Чтоб я знал, но он есть в примере для правого граничного условия в лекциях_

Также раскрываем второй и третий интегралы методом трапеций:

![](../assets/35.png)

Имеем по выведенной формуле:

![](../assets/36.png)

Из граничного условия имеем:

![](../assets/37.png)

Подставляем все это в уравнение:

![](../assets/38.png)

Приводим к "каноничному" виду:

![](../assets/39.png)

Коэффициенты будут соответственно KN, MN, PN.

Теперь вся задача сводится к тому, чтобы вычислить 4 массива, 6 параметров из граничных условий и передать и в метод решения прогонкой.
На выходе имеем искомый массив T(x).


<hr>

Спасибо @Krontand за то, что я теперь хотя бы понимаю, что происходит.


